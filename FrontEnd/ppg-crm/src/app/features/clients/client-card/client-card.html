<nz-card
  [nzBodyStyle]="{ padding: '10px' }"
  class="card client"
>
  <!-- Card header -->
  <nz-card-meta
    [nzTitle]="titleTemplate"
  ></nz-card-meta>

  <ng-template #titleTemplate>
      <nz-icon>
        <svg width="23" height="23" viewBox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.6875 1.93026V21.1691H13.0625V1.93026H3.6875ZM2.90625 0.181274H13.8438C14.051 0.181274 14.2497 0.273408 14.3962 0.437407C14.5427 0.601407 14.625 0.823837 14.625 1.05577V22.0436C14.625 22.2755 14.5427 22.498 14.3962 22.662C14.2497 22.826 14.051 22.9181 13.8438 22.9181H2.90625C2.69905 22.9181 2.50034 22.826 2.35382 22.662C2.20731 22.498 2.125 22.2755 2.125 22.0436V1.05577C2.125 0.823837 2.20731 0.601407 2.35382 0.437407C2.50034 0.273408 2.69905 0.181274 2.90625 0.181274Z" fill="black"/>
          <path d="M5.25 5.42822H11.5V7.17721H5.25V5.42822ZM5.25 10.6752H11.5V12.4242H5.25V10.6752ZM5.25 15.9221H11.5V17.6711H5.25V15.9221ZM14.625 12.4242H17.75V14.1732H14.625V12.4242ZM14.625 15.9221H17.75V17.6711H14.625V15.9221ZM0.5625 21.1691H22.4375V22.9181H0.5625V21.1691Z" fill="black"/>
          <path d="M14.625 8.92611V21.169H19.3125V8.92611H14.625ZM13.8438 7.17712H20.0938C20.301 7.17712 20.4997 7.26926 20.6462 7.43326C20.7927 7.59726 20.875 7.81969 20.875 8.05162V22.0435C20.875 22.2754 20.7927 22.4979 20.6462 22.6619C20.4997 22.8259 20.301 22.918 20.0938 22.918H13.8438C13.6365 22.918 13.4378 22.8259 13.2913 22.6619C13.1448 22.4979 13.0625 22.2754 13.0625 22.0435V8.05162C13.0625 7.81969 13.1448 7.59726 13.2913 7.43326C13.4378 7.26926 13.6365 7.17712 13.8438 7.17712Z" fill="black"/>
        </svg>
      </nz-icon>
    <span *ngIf="!isEditingCompanyName">{{ client()?.companyName }}</span>
    <nz-icon nzType="edit" class="edit-icon" *ngIf="!isEditingCompanyName" (click)="startEditing('companyName')"></nz-icon>
    <input #companyInput [(ngModel)]="client()!.companyName" *ngIf="isEditingCompanyName"
           (blur)="finishEditing('companyName')" (keyup.enter)="finishEditing('companyName')" />
  </ng-template>

  <!-- Client Info -->
  <div class="card-info-container">
    <div class="card-info-item">
      <span class="card-info-label">
        Director
         <nz-icon nzType="edit" class="edit-icon" (click)="startEditing('director')"></nz-icon>
      </span>
      <span *ngIf="!isEditingDirector">{{ client()?.director }}</span>
      <input #directorInput [(ngModel)]="client()!.director" *ngIf="isEditingDirector"
             (blur)="finishEditing('director')" (keyup.enter)="finishEditing('director')" />
    </div>

    <!-- Contact -->
    <div class="card-info-item">
      <span class="card-info-label">
        Contact Person
         <nz-icon nzType="edit" class="edit-icon" (click)="startEditing('contact')"></nz-icon>
      </span>
      <span *ngIf="!isEditingContact">{{ client()?.contactPerson }}</span>

      <input #contactInput [(ngModel)]="client()!.contactPerson" *ngIf="isEditingContact"
             (blur)="finishEditing('contact')" (keyup.enter)="finishEditing('contact')" />
    </div>

    <!-- Email -->
    <div class="card-info-item">
      <span class="card-info-label">
        Email
        <nz-icon nzType="edit" class="edit-icon" (click)="startEditing('email')"></nz-icon>
      </span>
      <span *ngIf="!isEditingEmail">{{ client()?.clientEmail }}</span>
      <input #emailInput [(ngModel)]="client()!.clientEmail" *ngIf="isEditingEmail"
             (blur)="finishEditing('email')" (keyup.enter)="finishEditing('email')" />
    </div>

    <!-- Phone -->
    <div class="card-info-item">
      <span class="card-info-label">
        Phone
        <nz-icon nzType="edit" class="edit-icon" (click)="startEditing('phone')"></nz-icon>
      </span>
      <span *ngIf="!isEditingPhone">{{ client()?.clientPhone }}</span>
      <input #phoneInput [(ngModel)]="client()!.clientPhone" *ngIf="isEditingPhone"
             (blur)="finishEditing('phone')" (keyup.enter)="finishEditing('phone')" />
    </div>
    <!-- Active Project -->
    <div class="card-info-item">
      <span class="card-info-label">Active Project</span>
      <ng-container *ngIf="activeProjects && activeProjects.length > 0; else noActiveProjects">
        <nz-card [nzBodyStyle]="{ padding: '0.25vh 0.25vw' }" *ngFor="let project of activeProjects">
          <nz-card-meta
            [nzTitle]="project.projectName"
          ></nz-card-meta>

          <div class="card-info-container">
            <div class="card-info-item">
              <span class="card-info-label">From:</span>
              <span>{{ project.startDate }}</span>
            </div>
            <div class="card-info-item">
              <span class="card-info-label">To:</span>
              <span>{{ project.endDate }}</span>
            </div>
          </div>

          <div class="card-status">
            <div class="card-status-item done">
              <!-- original SVG -->
              <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M6 0C2.68629 0 0 2.68629 0 6C0 9.31373 2.68629 12 6 12C9.31373 12 12 9.31373 12 6C12 2.68629 9.31373 0 6 0ZM3.50536 5.98309C3.34189 5.81961 3.07684 5.81961 2.91337 5.98309C2.74989 6.14657 2.74989 6.41157 2.91337 6.57505L4.58778 8.24947C4.75126 8.41295 5.01634 8.41295 5.17976 8.24947L9.08673 4.34251C9.25021 4.17904 9.25021 3.91399 9.08673 3.75051C8.92326 3.58704 8.65825 3.58704 8.49477 3.75051L4.88378 7.36147L3.50536 5.98309Z" fill="black"/>
              </svg>
              <span>{{ project.processCountByStatus['Done'] }} Done</span>
            </div>
            <div class="card-status-item in-progress">
              <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3V6H9" stroke="black" stroke-width="0.866667" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M6 11C8.7614 11 11 8.7614 11 6C11 3.23857 8.7614 1 6 1C3.23857 1 1 3.23857 1 6C1 8.7614 3.23857 11 6 11Z" stroke="black" stroke-width="0.866667" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>{{ project.processCountByStatus['InProgress'] }} In Progress</span>
            </div>
            <div class="card-status-item to-do">
              <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.5 12C9.53754 12 12 9.53754 12 6.5C12 3.46243 9.53754 1 6.5 1C3.46243 1 1 3.46243 1 6.5C1 9.53754 3.46243 12 6.5 12Z" stroke="black" stroke-width="0.533333" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>{{ project.processCountByStatus['ToDo'] }} To do</span>
            </div>
          </div>

          <nz-progress
            nz-tooltip
            nzTooltipTitle="3 done / 3 in progress / 4 to do"
            [nzPercent]="60"
            [nzSuccessPercent]="30"
            nzStrokeColor="#FFA220"
            [nzStrokeWidth]="3"
            [nzShowInfo]="false"
          ></nz-progress>
        </nz-card>
      </ng-container>

      <ng-template #noActiveProjects>
        <nz-card [nzBodyStyle]="{ padding: '0.25vh 0.25vw' }">
          <span>No active projects</span>
        </nz-card>
      </ng-template>

    </div>

    <!-- Project History -->
    <div class="card-info-item">
      <span class="card-info-label">Project History</span>

      <ng-container *ngIf="historyProjects && historyProjects.length > 0; else noHistoryProjects">
        <nz-card [nzBodyStyle]="{ padding: '0.25vh 0.25vw' }" *ngFor="let project of historyProjects">
          <span>{{ project.projectName }}</span>
        </nz-card>
      </ng-container>

      <ng-template #noHistoryProjects>
        <nz-card [nzBodyStyle]="{ padding: '0.25vh 0.25vw' }">
          <span>No project history</span>
        </nz-card>
      </ng-template>
    </div>
  </div>
</nz-card>
